(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{106:function(e,t,n){e.exports={main:"app_main__1wO9l"}},112:function(e,t,n){e.exports={container:"group_container__3XVzm"}},113:function(e,t,n){e.exports={overlay:"modal-overlay_overlay__pZ5VB"}},114:function(e,t,n){e.exports={list:"feed-list_list__gDe-L"}},115:function(e,t,n){e.exports={container:"orders_container__3gzih"}},116:function(e,t,n){e.exports={container:"order-info_container__24670"}},125:function(e,t,n){},21:function(e,t,n){e.exports={container:"profile-page_container__2Oxng",menu:"profile-page_menu__1R4bX",menu_item:"profile-page_menu_item__1m-qq",link:"profile-page_link__283WL",active_link:"profile-page_active_link__144D2"}},218:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(36),s=n.n(c),i=(n(125),n(106)),o=n.n(i),l=n(4),d=n(32),u=n.n(d),j=n(77),m=n.n(j),b=n(0),p=function(e){var t=e.text,n=e.children;return Object(b.jsxs)(l.Button,{type:"secondary",size:"medium",children:[Object(b.jsx)("span",{className:m.a.icon,children:n}),Object(b.jsx)("span",{className:"".concat(m.a.text," text ml-2"),children:t})]})},O=n(7),_=n(5);function x(e){var t=e.currentUserName,n=Object(O.h)().pathname;function a(e){return n===e?"primary":"secondary"}return Object(b.jsxs)("nav",{className:u.a.header,children:[Object(b.jsx)(_.c,{to:"/",exact:!0,activeClassName:u.a.link_active,className:u.a.link,children:Object(b.jsx)(p,{text:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440",children:Object(b.jsx)(l.BurgerIcon,{type:a("/")})})}),Object(b.jsx)(_.c,{to:"/feed",exact:!0,activeClassName:u.a.link_active,children:Object(b.jsx)(p,{text:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432",children:Object(b.jsx)(l.ListIcon,{type:a("/orders")})})}),Object(b.jsx)(_.b,{to:"/",className:u.a.link,children:Object(b.jsx)(l.Logo,{})}),Object(b.jsx)(_.c,{to:"/profile",activeClassName:u.a.link_active,children:Object(b.jsx)(p,{text:t||"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442",children:Object(b.jsx)(l.ProfileIcon,{type:a("/profile")})})})]})}var g=n(14),f=n(53),h=n.n(f),y=n(37),v=n.n(y),N=n(110),S=n(25),E=n(2),T=n(82),I=n(108),C="https://norma.nomoreparties.space/api",w=function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))},R=function(){var e=Object(I.a)(Object(T.a)().mark((function e(t,n){var a,r,c;return Object(T.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t,n);case 3:return a=e.sent,e.next=6,w(a);case 6:case 24:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(0),!(e.t0 instanceof Error&&"jwt expired"===e.t0.message)){e.next=27;break}return e.next=14,fetch(C+"/auth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then(w);case 14:return(r=e.sent).success||Promise.reject(r),localStorage.setItem("refreshToken",r.refreshToken),localStorage.setItem("accessToken",r.accessToken),n.headers.Authorization=r.accessToken,e.next=21,fetch(t,n);case 21:return c=e.sent,e.next=24,w(c);case 27:return e.abrupt("return",Promise.reject(e.t0));case 28:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),k="GET_INGREDIENTS_REQUEST",F="GET_INGREDIENTS_REQUEST_SUCCESS",q="GET_INGREDIENTS_REQUEST_FAILED",P={ingredientsRequestInProgress:!1,ingredientsRequestFailed:!1,ingredientsAll:[]},U=n(55),L=n(227),A="ADD_INGREDIENT",M="DELETE_INGREDIENT",D="PLACE_ORDER_REQUEST",G="PLACE_ORDER_REQUEST_SUCCESS",Q="PLACE_ORDER_REQUEST_FAILED",B="MOVE_CART_INGREDIENT",z={cartIngredients:[],orderRequestInProgress:!1,orderRequestFailed:!1,order:{number:0,textStatus:""}},W=function(e){var t=e.findIndex((function(e){return"bun"===e.type}));if(-1!==t&&e.length>1){var n=e.find((function(e){return"bun"===e.type}));e.splice(t,1),n&&e.unshift(n)}return e},J=n(26),V="REGISTER_REQUEST_SUCCESS",H="REGISTER_REQUEST_FAILED",X="LOGIN_REQUEST",K="LOGIN_REQUEST_SUCCESS",Z="LOGIN_REQUEST_FAILED",Y="LOGOUT_REQUEST",$="LOGOUT_REQUEST_SUCCESS",ee="LOGOUT_REQUEST_FAILED",te="FORGOT_PASSWORD_REQUEST_SUCCESS",ne="FORGOT_PASSWORD_REQUEST_FAILED",ae="RESET_PASSWORD_REQUEST_SUCCESS",re="RESET_PASSWORD_REQUEST_FAILED",ce="GET_USER_REQUEST",se="GET_USER_REQUEST_SUCCESS",ie="GET_USER_REQUEST_FAILED",oe="PATCH_USER_REQUEST_SUCCESS",le="PATCH_USER_REQUEST_FAILED",de="REGISTER_FORM_SET_VALUE",ue="FORGOT_PASSWORD_FORM_SET_VALUE",je="RESET_PASSWORD_FORM_SET_VALUE",me="LOGIN_FORM_SET_VALUE",be="PROFILE_FORM_SET_VALUE",pe="PROFILE_FORM_RESET",Oe="/auth/user",_e=function(){return function(e){var t=localStorage.getItem("accessToken");if(null===t)return new Error("Missing accessToken");e({type:ce}),R(C+Oe,{method:"GET",headers:{"Content-Type":"application/json",Authorization:t}}).then((function(t){t&&t.success?e({type:se,payload:{user:Object(E.a)(Object(E.a)({},t.user),{},{userIsLoading:!1})}}):e({type:ie,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:ie,payload:{message:t.message}})}))}},xe={currentUser:{name:"",email:"",userIsLoading:!1},registration:{form:{name:"",email:"",password:""},requestFailed:!1,requestFailMessage:null},forgotPassword:{form:{email:""},requestSuccess:!1,requestFailed:!1,requestFailMessage:null},resetPassword:{form:{password:"",token:""},requestSuccess:!1,requestFailed:!1,requestFailMessage:null},login:{form:{email:"",password:""},requestFailed:!1,requestFailMessage:null},profile:{form:{name:"",email:"",password:""},requestSuccess:!1,requestFailed:!1,requestFailMessage:null},logout:{requestInProgress:!1,requestSuccess:!1,requestFailed:!1,requestFailMessage:null}},ge="WS_CONNECTION_START",fe="WS_CONNECTION_STOP",he="WS_CONNECTION_SUCCESS",ye="WS_CONNECTION_ERROR",ve="WS_CONNECTION_CLOSED",Ne="WS_GET_MESSAGE",Se={wsStart:ge,wsStop:fe,onOpen:he,onClose:ve,onError:ye,onMessage:Ne},Ee={wsConnected:!1,ordersArray:[],totalOrders:0,totalOrdersToday:0},Te=Object(S.b)({ingredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(E.a)(Object(E.a)({},e),{},{ingredientsRequestInProgress:!0,ingredientsRequestFailed:!1});case F:return Object(E.a)(Object(E.a)({},e),{},{ingredientsAll:t.payload,ingredientsRequestInProgress:!1});case q:return Object(E.a)(Object(E.a)({},e),{},{ingredientsRequestFailed:!0,ingredientsRequestInProgress:!1});default:return e}},cart:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case A:return Object(E.a)(Object(E.a)({},e),{},{cartIngredients:"bun"===t.payload.type?W([].concat(Object(U.a)(e.cartIngredients.filter((function(e){return"bun"!==e.type}))),[t.payload]).concat()):[].concat(Object(U.a)(e.cartIngredients),[t.payload])});case M:return Object(E.a)(Object(E.a)({},e),{},{cartIngredients:Object(U.a)(e.cartIngredients).filter((function(e){return e.uuid!==t.payload.uuid}))});case D:return Object(E.a)(Object(E.a)({},e),{},{orderRequestInProgress:!0,orderRequestFailed:!1,order:{number:0,textStatus:"\u041e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435..."}});case G:return Object(E.a)(Object(E.a)({},e),{},{order:Object(E.a)(Object(E.a)({},t.payload),{},{textStatus:""}),orderRequestInProgress:!1,cartIngredients:[]});case Q:return Object(E.a)(Object(E.a)({},e),{},{orderRequestInProgress:!1,orderRequestFailed:!0,order:{number:0,textStatus:"\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430"}});case B:var n=function(e,t,n){return e.map((function(a,r){return r===t?e[n]:r===n?e[t]:a}))};return-1!==e.cartIngredients.findIndex((function(e){return"bun"===e.type}))&&(t.payload.dragIndex++,t.payload.hoverIndex++),Object(E.a)(Object(E.a)({},e),{},{cartIngredients:n(e.cartIngredients,t.payload.dragIndex,t.payload.hoverIndex)});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case de:return Object(E.a)(Object(E.a)({},e),{},{registration:Object(E.a)(Object(E.a)({},e.registration),{},{form:Object(E.a)(Object(E.a)({},e.registration.form),{},Object(J.a)({},t.payload.field,t.payload.value)),requestFailed:!1,requestFailMessage:null})});case K:case V:return Object(E.a)(Object(E.a)({},e),{},{currentUser:t.payload.user});case H:return Object(E.a)(Object(E.a)({},e),{},{registration:Object(E.a)(Object(E.a)({},e.registration),{},{requestFailed:!0,requestFailMessage:t.payload.message})});case ue:return Object(E.a)(Object(E.a)({},e),{},{forgotPassword:Object(E.a)(Object(E.a)({},e.forgotPassword),{},{form:Object(E.a)(Object(E.a)({},e.forgotPassword.form),{},Object(J.a)({},t.payload.field,t.payload.value)),requestFailed:!1,requestFailMessage:null})});case te:return Object(E.a)(Object(E.a)({},e),{},{forgotPassword:Object(E.a)(Object(E.a)({},e.forgotPassword),{},{requestSuccess:!0})});case ne:return Object(E.a)(Object(E.a)({},e),{},{forgotPassword:Object(E.a)(Object(E.a)({},e.forgotPassword),{},{requestFailed:!0,requestFailMessage:t.payload.message})});case je:return Object(E.a)(Object(E.a)({},e),{},{resetPassword:Object(E.a)(Object(E.a)({},e.resetPassword),{},{form:Object(E.a)(Object(E.a)({},e.resetPassword.form),{},Object(J.a)({},t.payload.field,t.payload.value))})});case ae:return Object(E.a)(Object(E.a)({},e),{},{resetPassword:Object(E.a)(Object(E.a)({},e.resetPassword),{},{requestSuccess:!0})});case re:return Object(E.a)(Object(E.a)({},e),{},{resetPassword:Object(E.a)(Object(E.a)({},e.resetPassword),{},{requestFailed:!0,requestFailMessage:t.payload.message})});case me:return Object(E.a)(Object(E.a)({},e),{},{login:Object(E.a)(Object(E.a)({},e.login),{},{form:Object(E.a)(Object(E.a)({},e.login.form),{},Object(J.a)({},t.payload.field,t.payload.value)),requestFailed:!1,requestFailMessage:null})});case Z:return Object(E.a)(Object(E.a)({},e),{},{login:Object(E.a)(Object(E.a)({},e.login),{},{requestFailed:!0,requestFailMessage:t.payload.message}),currentUser:Object(E.a)(Object(E.a)({},e.currentUser),{},{userIsLoading:!1})});case be:return Object(E.a)(Object(E.a)({},e),{},{profile:Object(E.a)(Object(E.a)({},e.profile),{},{form:Object(E.a)(Object(E.a)({},e.profile.form),{},Object(J.a)({},t.payload.field,t.payload.value)),requestFailed:!1,requestFailMessage:null})});case pe:return Object(E.a)(Object(E.a)({},e),{},{profile:Object(E.a)(Object(E.a)({},e.profile),{},{form:Object(E.a)(Object(E.a)({},e.profile.form),{},{name:e.currentUser.name,email:e.currentUser.email})})});case X:case ce:return Object(E.a)(Object(E.a)({},e),{},{currentUser:Object(E.a)(Object(E.a)({},e.currentUser),{},{userIsLoading:!0})});case se:case oe:return Object(E.a)(Object(E.a)({},e),{},{profile:Object(E.a)(Object(E.a)({},e.profile),{},{form:Object(E.a)(Object(E.a)({},e.profile.form),{},{email:t.payload.user.email,name:t.payload.user.name}),requestSuccess:!0,requestFailed:!1,requestFailMessage:null}),currentUser:t.payload.user});case ie:return Object(E.a)(Object(E.a)({},e),{},{profile:Object(E.a)(Object(E.a)({},e.profile),{},{requestFailed:!0,requestFailMessage:t.payload.message}),currentUser:Object(E.a)(Object(E.a)({},e.currentUser),{},{userIsLoading:!1})});case Y:return Object(E.a)(Object(E.a)({},e),{},{logout:Object(E.a)(Object(E.a)({},e.logout),{},{requestInProgress:!0})});case $:return Object(E.a)(Object(E.a)({},e),{},{currentUser:{name:"",email:"",userIsLoading:!1},logout:Object(E.a)(Object(E.a)({},e.logout),{},{requestSuccess:!0,requestInProgress:!1}),login:Object(E.a)(Object(E.a)({},e.login),{},{form:Object(E.a)(Object(E.a)({},e.login.form),{},{email:"",password:""})})});default:return e}},ws:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ee,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ge:return Object(E.a)(Object(E.a)({},e),{},{wsConnected:!1});case he:return Object(E.a)(Object(E.a)({},e),{},{wsConnected:!0});case ye:case ve:return Object(E.a)(Object(E.a)({},e),{},{wsConnected:!1});case Ne:return Object(E.a)(Object(E.a)({},e),{},{totalOrders:t.payload.total,totalOrdersToday:t.payload.totalToday,ordersArray:t.payload.orders});default:return e}}}),Ie=n(45),Ce=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||S.c,we=Ce(Object(S.a)(N.a,function(e){return function(t){var n=null;return function(a){return function(r){var c=t.dispatch,s=(t.getState,r.type),i=r.payload,o=e.wsStart,l=e.wsStop,d=e.onOpen,u=e.onClose,j=e.onError,m=e.onMessage;s!==o||null!==n&&3!==n.readyState?n&&s===l&&n.close():(n=new WebSocket(i.wsUrl+("undefined"!==typeof i.token?"?token="+i.token:"")))&&(n.onopen=function(e){c({type:d,payload:e})},n.onerror=function(e){c({type:j,payload:e})},n.onclose=function(e){c({type:u,payload:e})},n.onmessage=function(e){c({type:m,payload:JSON.parse(e.data)})}),a(r)}}}}(Se))),Re=Object(S.d)(Te,we),ke=Ie.c,Fe=function(){return Object(Ie.b)()},qe=n(225);function Pe(e){var t=e.ingredientObj,n=ke((function(e){return e.cart.cartIngredients}))||[],a=Object(O.h)(),r=n.filter((function(e){return e._id===t._id})).length;"bun"===t.type&&(r*=2);var c=Object(qe.a)({type:"ingredient",item:t,collect:function(e){return{opacity:e.isDragging()?.2:1}}}),s=Object(g.a)(c,2),i=s[0].opacity,o=s[1];return Object(b.jsx)("div",{className:v.a.container,ref:o,style:{opacity:i},"data-test":"ingredient_container",children:Object(b.jsxs)(_.b,{className:v.a.link,to:{pathname:"/ingredients/".concat(t._id),state:{prevLocation:a}},children:[r>0&&Object(b.jsx)(l.Counter,{count:r,size:"default"}),Object(b.jsx)("img",{className:v.a.image,src:t.image,alt:t.name}),Object(b.jsxs)("div",{className:v.a.price,children:[Object(b.jsx)("span",{className:"text_type_digits-default pr-1",children:t.price}),Object(b.jsx)(l.CurrencyIcon,{type:"primary"})]}),Object(b.jsx)("div",{className:"".concat(v.a.itemName," text_type_main-default"),children:t.name})]})})}var Ue=n(112),Le=n.n(Ue);function Ae(e){var t=e.id,n=e.title,a=e.ingredients;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h2",{className:"text_type_main-medium",id:t,children:n}),Object(b.jsx)("div",{className:Le.a.container,children:a.map((function(e,t){return Object(b.jsx)(Pe,{ingredientObj:e},e._id)}))})]})}function Me(){var e=[{type:"bun",name:"\u0411\u0443\u043b\u043a\u0438"},{type:"sauce",name:"\u0421\u043e\u0443\u0441\u044b"},{type:"main",name:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"}],t=Object(a.useState)("bun"),n=Object(g.a)(t,2),r=n[0],c=n[1],s=ke((function(e){return e.ingredients.ingredientsAll}))||[];return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)("div",{className:"".concat(h.a.container," pt-10"),children:[Object(b.jsx)("h1",{className:"text_type_main-large",children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(b.jsx)("nav",{className:h.a.tabs,children:e.map((function(e,t){return Object(b.jsx)(l.Tab,{onClick:function(){return function(e){c(e);var t=document.getElementById("group_"+e);t&&t.scrollIntoView({behavior:"smooth"})}(e.type)},active:e.type===r,value:e.type,children:e.name},t)}))}),Object(b.jsx)("section",{className:"".concat(h.a.groups," custom-scroll"),onScroll:function(t){return function(t){var n=t.currentTarget.offsetTop,a=e.reduce((function(e,t){var a=document.getElementById("group_"+e.type),r=document.getElementById("group_"+t.type);return a&&r?Math.abs(a.getBoundingClientRect().y-n)<Math.abs(r.getBoundingClientRect().y-n)?e:t:e}));c(a.type)}(t)},children:e.map((function(e,t){return Object(b.jsx)(Ae,{title:e.name,ingredients:s.filter((function(t){return e.type===t.type})),id:"group_"+e.type},t)}))})]})})}var De=n(80),Ge=n.n(De),Qe=n(226);function Be(e){var t=Fe(),n=Object(a.useRef)(null),r=Object(qe.a)({type:"cartIngredient",item:{index:e.index},collect:function(e){return{isDrag:e.isDragging()}}}),c=Object(g.a)(r,2),s=c[0].isDrag,i=c[1],o=Object(Qe.a)({accept:"cartIngredient",collect:function(e){return{isOver:e.isOver()}},hover:function(a,r){var c=a.index,s=e.index;if(c!==s){var i=n.current;if(i){var o=i.getBoundingClientRect(),l=(o.bottom-o.top)/2,d=r.getClientOffset();if(d){var u=d.y-o.top;if(c<s&&u<l)return;if(c>s&&u>l)return}}t({type:B,payload:{dragIndex:c,hoverIndex:s}}),a.index=s}}}),d=Object(g.a)(o,2),u=d[0].isOver;return i((0,d[1])(n)),Object(b.jsxs)("div",{className:Ge.a.container,ref:n,style:{border:u?"1px dashed green":"",opacity:s?.2:1},children:[Object(b.jsx)("div",{className:Ge.a.drag_icon,children:Object(b.jsx)(l.DragIcon,{type:"primary"})}),Object(b.jsx)(l.ConstructorElement,{text:e.ingredient.name,thumbnail:e.ingredient.image_mobile,price:e.ingredient.price,isLocked:!1,handleClose:function(){t({type:M,payload:e.ingredient})}})]})}var ze=n(81),We=n.n(ze);function Je(e){var t=ke((function(e){return e.cart.cartIngredients}))||[];return Object(b.jsxs)("div",{className:"".concat(We.a.container," mt-10"),children:[Object(b.jsx)("div",{className:"text_type_digits-medium mr-2",children:e.total}),Object(b.jsx)("div",{className:We.a.currency,children:Object(b.jsx)(l.CurrencyIcon,{type:"primary"})}),Object(b.jsx)("div",{className:"pl-10","data-testid":"place_order_button",children:t.some((function(e){return"bun"===e.type}))?Object(b.jsx)(l.Button,{type:"primary",size:"large",onClick:e.showOrderDetails,children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"}):null})]})}var Ve=n(38),He=n.n(Ve),Xe=n(54),Ke=n.n(Xe),Ze=n(113),Ye=n.n(Ze),$e=function(e){var t=e.onModalClose,n=e.children;return Object(b.jsx)("div",{className:Ye.a.overlay,onClick:function(e){e.target===e.currentTarget&&t()},"data-testid":"modal_overlay",children:n})},et=function(e){var t=e.title,n=e.children,a=e.onModalClose;r.a.useEffect((function(){return document.addEventListener("keydown",c),function(){document.removeEventListener("keydown",c)}}));var c=function(e){"Escape"===e.key&&a()};return s.a.createPortal(Object(b.jsx)($e,{onModalClose:a,children:Object(b.jsxs)("div",{className:"".concat(Ke.a.window," pt-10 pr-10 pb-15 pl-10"),children:[Object(b.jsxs)("header",{className:Ke.a.title,children:[Object(b.jsx)("p",{className:"text text_type_main-medium",children:t}),Object(b.jsx)("div",{className:Ke.a.closeButton,onClick:a,"data-testid":"modal_close_button",children:Object(b.jsx)(l.CloseIcon,{type:"primary"})})]}),n]})}),document.getElementById("react-modals"))},tt=n(27),nt=n.n(tt),at=n.p+"static/media/done.f3932884.png",rt=function(e){var t=e.orderNumber,n=e.orderStatus;return Object(b.jsx)("div",{className:nt.a.windowBody,children:0!==t?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"".concat(nt.a.centerText," text_type_digits-large "),children:t}),Object(b.jsx)("p",{className:"".concat(nt.a.centerText," mt-8 text text_type_main-medium "),children:"\u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(b.jsx)("div",{className:nt.a.centerText,children:Object(b.jsx)("img",{className:"".concat(nt.a.doneImage," mt-15"),src:at,alt:"OK"})}),Object(b.jsx)("p",{className:"".concat(nt.a.centerText," mt-15 text text_type_main-small "),children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043d\u0430\u0447\u0430\u043b\u0438 \u0433\u043e\u0442\u043e\u0432\u0438\u0442\u044c"}),Object(b.jsx)("p",{className:"".concat(nt.a.centerText," mt-2 mb-20 text text_type_main-small text_color_inactive "),children:"\u0414\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0433\u043e\u0442\u043e\u0432\u043d\u043e\u0441\u0442\u0438 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0430\u043b\u044c\u043d\u043e\u0439 \u0441\u0442\u0430\u043d\u0446\u0438\u0438"})]}):Object(b.jsx)("h2",{className:"text text_type_main-large",children:n})})};function ct(){var e=Object(a.useState)(!1),t=Object(g.a)(e,2),n=t[0],r=t[1],c=ke((function(e){return e.cart.cartIngredients}))||[],s=ke((function(e){return e.cart.order}))||{number:0},i=ke((function(e){return e.user.currentUser.email})),o=Fe(),d=Object(O.g)(),u=Object(Qe.a)({accept:"ingredient",drop:function(e){o(function(e){return{type:A,payload:Object(E.a)(Object(E.a)({},e),{},{uuid:Object(L.a)()})}}(e))},collect:function(e){return{isHover:e.isOver()}}}),j=Object(g.a)(u,2),m=j[0].isHover,p=j[1],_=m?"lightgreen":"transparent",x=null,f=0,h=[];return c.length&&(f=c.reduce((function(e,t){return e+("bun"===t.type?2*t.price:t.price)}),0),x=c.find((function(e){return"bun"===e.type})),h=c.filter((function(e){return"bun"!==e.type}))),Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"".concat(He.a.container," pt-25 ml-10"),children:[Object(b.jsxs)("div",{className:He.a.dropTarget,style:{borderColor:_},ref:p,"data-testid":"cart_drop_target",children:[x&&Object(b.jsx)("div",{className:He.a.bun,children:Object(b.jsx)(l.ConstructorElement,{type:"top",text:"".concat(x.name,"\n(\u0432\u0435\u0440\u0445)"),thumbnail:x.image_mobile,price:x.price,isLocked:!0})}),Object(b.jsx)("section",{className:"".concat(He.a.drag_list," custom-scroll pr-2 mt-4 mb-4"),children:h.map((function(e,t){return Object(b.jsx)(Be,{ingredient:e,index:t},e.uuid)}))}),x&&Object(b.jsx)("div",{className:He.a.bun,children:Object(b.jsx)(l.ConstructorElement,{type:"bottom",text:"".concat(x.name,"\n(\u043d\u0438\u0437)"),thumbnail:x.image_mobile,price:x.price,isLocked:!0})})]}),0!==f?Object(b.jsx)(Je,{total:f,showOrderDetails:function(){i?(r(!0),o(function(e){return function(t){var n=localStorage.getItem("accessToken");if(null===n)return new Error("Missing accessToken");t({type:D}),R(C+"/orders",{method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({ingredients:e.map((function(e){return e._id}))})}).then((function(e){e&&e.success&&e.order?t({type:G,payload:e.order}):t({type:Q})})).catch((function(e){t({type:Q})}))}}(c))):d.replace({pathname:"/login"})}}):Object(b.jsx)("h2",{className:"text text_type_main-meduim",children:"\u0422\u044f\u043d\u0438 \u0441\u044e\u0434\u0430"})]}),n&&Object(b.jsx)(et,{onModalClose:function(){r(!1)},children:Object(b.jsx)(rt,{orderNumber:s.number,orderStatus:s.textStatus})})]})}var st,it=n(33),ot=n.n(it);function lt(){var e=ke((function(e){return e.ingredients.ingredientsAll}))||[],t=Object(O.i)().id,n=e.find((function(e){return e._id===t}));return n?Object(b.jsxs)("div",{className:ot.a.windowBody,children:[Object(b.jsx)("img",{src:n.image_large,alt:n.name}),Object(b.jsx)("div",{className:"mt-4 text text_type_main-default",children:n.name}),Object(b.jsxs)("ul",{className:"".concat(ot.a.calories," mt-8"),children:[Object(b.jsxs)("li",{className:ot.a.caloriesItem,children:[Object(b.jsx)("div",{className:"text text_type_main-small text_color_inactive",children:"\u041a\u0430\u043b\u043e\u0440\u0438\u0438, \u043a\u0430\u043b\u043b"}),Object(b.jsx)("div",{className:"text text_type_digits-default text_color_inactive",children:n.calories})]}),Object(b.jsxs)("li",{className:ot.a.caloriesItem,children:[Object(b.jsx)("div",{className:"text text_type_main-small text_color_inactive",children:"\u0411\u0435\u043b\u043a\u0438, \u0433"}),Object(b.jsx)("div",{className:"text text_type_digits-default text_color_inactive",children:n.proteins})]}),Object(b.jsxs)("li",{className:ot.a.caloriesItem,children:[Object(b.jsx)("div",{className:"text text_type_main-small text_color_inactive",children:"\u0416\u0438\u0440\u044b, \u0433"}),Object(b.jsx)("div",{className:"text text_type_digits-default text_color_inactive",children:n.fat})]}),Object(b.jsxs)("li",{className:ot.a.caloriesItem,children:[Object(b.jsx)("div",{className:"text text_type_main-small text_color_inactive",children:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b, \u0433"}),Object(b.jsx)("div",{className:"text text_type_digits-default text_color_inactive",children:n.carbohydrates})]})]})]}):Object(b.jsx)("h1",{className:"text text_type_main-large",children:" \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}function dt(e){return{_id:e,name:"missing",type:"missing",price:0,proteins:0,fat:0,calories:0,carbohydrates:0,image:"missing",image_mobile:"missing",image_large:"missing"}}!function(e){e.created="created",e.pending="pending",e.done="done"}(st||(st={}));var ut=n(22),jt=n.n(ut);function mt(e){return new Date(e).toLocaleTimeString("ru-RU",{month:"long",hour:"numeric",minute:"numeric"})}function bt(){var e=Object(O.i)().orderNumber,t=Object(a.useState)(),n=Object(g.a)(t,2),r=n[0],c=n[1],s=Object(a.useState)(""),i=Object(g.a)(s,2),o=i[0],d=i[1],u=ke((function(e){return e.ingredients})).ingredientsAll,j="/orders/"+e,m="\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e",p=[],_={},x=0,f="";return Object(a.useEffect)((function(){fetch(C+j).then(w).then((function(e){e&&e.success&&e.orders&&e.orders[0]?c(e.orders[0]):d("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435")})).catch((function(e){d("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435")}))}),[]),r&&u&&(p=r.ingredients.map((function(e){var t=u.find((function(t){return t._id===e}));return"undefined"!==typeof _[e]&&t?_[e].quantity++:t&&(_[e]={ingredient:t,quantity:"bun"===t.type?2:1}),t||dt(e)})),r.status===st.done?m="\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d":r.status===st.pending?m="\u0413\u043e\u0442\u043e\u0432\u0438\u0442\u0441\u044f":r.status===st.created&&(m="\u0421\u043e\u0437\u0434\u0430\u043d"),f=mt(r.createdAt),x=p.reduce((function(e,t){return t?e+("bun"===t.type?2*t.price:t.price):0}),0)),r?Object(b.jsxs)("div",{className:jt.a.container,children:[Object(b.jsxs)("h3",{className:"".concat(jt.a.orderNumber," text text_type_digits-default"),children:["#",r.number]}),Object(b.jsx)("h2",{className:"text text_type_main-medium mt-10",children:r.name}),Object(b.jsx)("p",{className:"".concat(r.status===st.done?jt.a.readyOrder:null," text text text_type_main-small mt-3"),children:m}),Object(b.jsx)("h4",{className:"text text_type_main-medium mt-15",children:"\u0421\u043e\u0441\u0442\u0430\u0432:"}),Object(b.jsx)("ul",{className:"".concat(jt.a.ingredientList," mt-6 custom-scroll"),children:Object.values(_).map((function(e){return Object(b.jsxs)("li",{className:"".concat(jt.a.ingredientRow," mt-4"),children:[Object(b.jsx)("img",{className:jt.a.ingrImage,src:e.ingredient.image,alt:e.ingredient.name}),Object(b.jsxs)("div",{className:"".concat(jt.a.titlePriceContainer," pr-6"),children:[Object(b.jsx)("p",{className:"text text text_type_main-small pl-4",children:e.ingredient.name}),Object(b.jsxs)("div",{className:jt.a.price,children:[Object(b.jsxs)("span",{className:"text text_type_digits-default pr-1",children:[e.quantity," x ",e.ingredient.price]}),Object(b.jsx)(l.CurrencyIcon,{type:"primary"})]})]})]},e.ingredient._id)}))}),Object(b.jsxs)("div",{className:"".concat(jt.a.bottom," mt-10"),children:[Object(b.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:f}),Object(b.jsxs)("div",{className:jt.a.total,children:[Object(b.jsx)("span",{className:"text text_type_digits-default pr-1",children:x}),Object(b.jsx)(l.CurrencyIcon,{type:"primary"})]})]})]}):o?Object(b.jsxs)("h1",{children:[" ",o," "]}):Object(b.jsx)("h1",{className:"text text_type_main-large",children:" \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}var pt=n(224),Ot=n(119),_t=n(9),xt=n.n(_t);function gt(){var e,t=ke((function(e){return e.user.login.form})),n=t.email,a=t.password,r=ke((function(e){return e.user.login})),c=r.requestFailed,s=r.requestFailMessage,i=ke((function(e){return e.user.currentUser})),o=Fe(),d=Object(O.h)();if(i.email&&!i.userIsLoading)return Object(b.jsx)(O.a,{to:(null===(e=d.state)||void 0===e?void 0:e.prevLocation)||"/"});var u=function(e){var t,n;o((t=e.target.name,n=e.target.value,{type:me,payload:{field:t,value:n}}))};return Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsxs)("form",{className:xt.a.form,onSubmit:function(e){e.preventDefault(),o(function(e){var t=e.email,n=e.password;return function(e){e({type:X}),fetch(C+"/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})}).then(w).then((function(t){t&&t.success?(e({type:K,payload:{user:Object(E.a)(Object(E.a)({},t.user),{},{userIsLoading:!1})}}),localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("refreshToken",t.refreshToken)):e({type:Z,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:Z,payload:{message:t.message}})}))}}({email:n,password:a}))},children:[Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0412\u0445\u043e\u0434"}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{type:"email",onChange:u,name:"email",value:n,placeholder:"E-mail",error:c,errorText:s||void 0})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.PasswordInput,{onChange:u,name:"password",value:a})}),Object(b.jsx)("div",{className:"mt-6","data-testid":"login_submit_button",children:Object(b.jsx)(l.Button,{type:"primary",htmlType:"submit",size:"large",children:"\u0412\u043e\u0439\u0442\u0438"})}),Object(b.jsxs)("p",{className:"text_type_main-default text_color_inactive mt-20",children:["\u0412\u044b\xa0\u2014 \u043d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",Object(b.jsx)(_.b,{to:"/register",className:"pl-2",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]}),Object(b.jsxs)("p",{className:"text_type_main-default text_color_inactive mt-4",children:["\u0417\u0430\u0431\u044b\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",Object(b.jsx)(_.b,{to:"/forgot-password",className:"pl-2",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})]})]})})}function ft(){var e,t=ke((function(e){return e.user.registration.form})),n=t.name,a=t.email,r=t.password,c=ke((function(e){return e.user.registration})),s=c.requestFailed,i=c.requestFailMessage,o=ke((function(e){return e.user.currentUser.email})),d=Fe(),u=Object(O.h)();if(o)return Object(b.jsx)(O.a,{to:(null===(e=u.state)||void 0===e?void 0:e.prevLocation)||"/"});var j=function(e){var t,n;d((t=e.target.name,n=e.target.value,{type:de,payload:{field:t,value:n}}))};return Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsxs)("form",{className:xt.a.form,onSubmit:function(e){e.preventDefault(),d(function(e){var t=e.name,n=e.email,a=e.password;return function(e){e({type:"REGISTER_REQUEST"}),fetch(C+"/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,email:n,password:a})}).then(w).then((function(t){t&&t.success&&t.accessToken?(e({type:V,payload:{user:Object(E.a)(Object(E.a)({},t.user),{},{userIsLoading:!1})}}),localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("refreshToken",t.refreshToken)):e({type:H,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:H,payload:{message:t.message}})}))}}({name:n,email:a,password:r}))},children:[Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{onChange:j,name:"name",value:n,placeholder:"\u0418\u043c\u044f"})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{type:"email",onChange:j,name:"email",value:a,placeholder:"E-mail",error:s,errorText:i||void 0})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.PasswordInput,{onChange:j,name:"password",value:r})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Button,{type:"primary",htmlType:"submit",size:"large",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})}),Object(b.jsxs)("p",{className:"text_type_main-default text_color_inactive mt-20",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?",Object(b.jsx)(_.b,{to:"/login",className:"pl-2",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}function ht(){var e=ke((function(e){return e.user.forgotPassword.form})).email,t=ke((function(e){return e.user.forgotPassword})),n=t.requestSuccess,a=t.requestFailed,r=(t.requestFailMessage,Fe());Object(O.h)();return n?Object(b.jsx)(O.a,{to:"/reset-password"}):Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsxs)("form",{className:xt.a.form,onSubmit:function(t){t.preventDefault(),r(function(e){return function(t){t({type:"FORGOT_PASSWORD_REQUEST"}),fetch(C+"/password-reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}).then(w).then((function(e){e&&e.success?t({type:te,payload:{message:null===e||void 0===e?void 0:e.message}}):t({type:ne,payload:{message:null===e||void 0===e?void 0:e.message}})})).catch((function(e){t({type:ne,payload:{message:e.message}})}))}}(e))},children:[Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{onChange:function(e){var t,n;r((t=e.target.name,n=e.target.value,{type:ue,payload:{field:t,value:n}}))},name:"email",type:"email",value:e,placeholder:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 e-mail",error:a})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Button,{type:"primary",htmlType:"submit",size:"large",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c"})}),Object(b.jsxs)("p",{className:"text_type_main-default text_color_inactive mt-20",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",Object(b.jsx)(_.b,{to:"/login",className:"pl-2",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}function yt(){var e=ke((function(e){return e.user.resetPassword.form})),t=e.password,n=e.token,a=ke((function(e){return e.user.resetPassword})),r=a.requestSuccess,c=a.requestFailed,s=a.requestFailMessage,i=ke((function(e){return e.user.forgotPassword.requestSuccess})),o=Fe();if(r)return Object(b.jsx)(O.a,{to:"/login"});if(!i)return Object(b.jsx)(O.a,{to:"/forgot-password"});var d=function(e){var t,n;o((t=e.target.name,n=e.target.value,{type:je,payload:{field:t,value:n}}))};return Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsxs)("form",{className:xt.a.form,onSubmit:function(e){e.preventDefault(),o(function(e){var t=e.password,n=e.token;return function(e){e({type:"RESET_PASSWORD_REQUEST"}),fetch(C+"/password-reset/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,token:n})}).then(w).then((function(t){t&&t.success?e({type:ae}):e({type:re,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:re,payload:{message:t.message}})}))}}({password:t,token:n}))},children:[Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f"}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{onChange:d,name:"password",type:"password",value:t,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c"})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{onChange:d,name:"token",value:n,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0434 \u0438\u0437 \u043f\u0438\u0441\u044c\u043c\u0430",error:c,errorText:s||void 0})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Button,{type:"primary",htmlType:"submit",size:"large",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})}),Object(b.jsxs)("p",{className:"text_type_main-default text_color_inactive mt-20",children:["\u0412\u0441\u043f\u043e\u043c\u043d\u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c?",Object(b.jsx)(_.b,{to:"/login",className:"pl-2",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})})}var vt=n(21),Nt=n.n(vt);function St(){var e=ke((function(e){return e.user.profile.form})),t=e.name,n=e.email,r=e.password,c=ke((function(e){return e.user.profile})),s=c.requestSuccess,i=c.requestFailed,o=c.requestFailMessage,d=Fe();Object(a.useEffect)((function(){d(_e())}),[d]);var u=function(e){var t,n;d((t=e.target.name,n=e.target.value,{type:be,payload:{field:t,value:n}}))};return s?Object(b.jsxs)("form",{className:xt.a.form,onSubmit:function(e){e.preventDefault(),d(function(e){var t=e.name,n=e.email,a=e.password;return function(e){var r=localStorage.getItem("accessToken");if(null===r)return new Error("Missing accessToken");e({type:"PATCH_USER_REQUEST"}),R(C+Oe,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:r},body:JSON.stringify({name:t,email:n,password:a})}).then((function(t){t&&t.success?e({type:oe,payload:{user:t.user}}):e({type:le,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:le,payload:{message:t.message}})}))}}({name:t,email:n,password:r}))},children:[Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{onChange:u,name:"name",value:t,placeholder:"\u0418\u043c\u044f"})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.Input,{type:"email",onChange:u,name:"email",value:n,placeholder:"\u041b\u043e\u0433\u0438\u043d(E-mail)",error:i,errorText:o||void 0})}),Object(b.jsx)("div",{className:"mt-6",children:Object(b.jsx)(l.PasswordInput,{onChange:u,name:"password",value:r})}),Object(b.jsxs)("div",{className:"mt-6",children:[Object(b.jsx)(l.Button,{type:"secondary",size:"medium",htmlType:"reset",onClick:function(e){d({type:pe})},children:"\u041e\u0442\u043c\u0435\u043d\u0430"}),Object(b.jsx)(l.Button,{type:"primary",htmlType:"submit",size:"medium",children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})]})]}):Object(b.jsx)("h1",{className:"".concat(xt.a.container," text text_type_main-large"),children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})}var Et=n(24),Tt=n.n(Et);function It(e){var t=e.orderObj,n=Object(O.h)(),a=t.ingredients.reduce((function(e,t){return t?e+("bun"===t.type?2*t.price:t.price):0}),0),r=t.ingredients.length>6?t.ingredients.length-6:0,c=t.ingredients.slice(0,6),s=mt(t.createdAt);return Object(b.jsx)(_.c,{to:{pathname:"".concat(n.pathname,"/").concat(t.number),state:{prevLocation:n}},className:Tt.a.orderLink,children:Object(b.jsxs)("div",{className:"".concat(Tt.a.container," p-6 mb-4 mr-2"),children:[Object(b.jsxs)("div",{className:"".concat(Tt.a.header),children:[Object(b.jsxs)("p",{className:"text text_type_digits-default",children:["#",t.number]}),Object(b.jsx)("p",{className:"text text_type_main-default text_color_inactive",children:s})]}),Object(b.jsx)("h2",{className:"text text_type_main-medium mt-6",children:t.name}),Object(b.jsxs)("div",{className:"".concat(Tt.a.bottom," mt-6"),children:[Object(b.jsx)("ul",{className:"".concat(Tt.a.ingredients),children:c.map((function(e,t){return Object(b.jsxs)("div",{className:Tt.a.imageContainer,children:[Object(b.jsx)("img",{className:Tt.a.ingrImage,src:e.image}),0===t&&r?Object(b.jsxs)("div",{className:"".concat(Tt.a.overflowCounter," text text_type_main-default"),children:["+",r]}):null]},t)}))}),Object(b.jsxs)("div",{className:Tt.a.total,children:[Object(b.jsx)("span",{className:"text text_type_digits-default pr-1",children:a}),Object(b.jsx)(l.CurrencyIcon,{type:"primary"})]})]})]})})}var Ct=n(114),wt=n.n(Ct);function Rt(){var e=ke((function(e){return e.ingredients})),t=e.ingredientsAll,n=e.ingredientsRequestFailed,a=e.ingredientsRequestInProgress,r=ke((function(e){return e.ws})).ordersArray,c=[];return r&&(c=r.map((function(e){var n=e.ingredients.map((function(e){var n=t.find((function(t){return t._id===e}));return n||dt(e)}));return{_id:e._id,status:e.status,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,number:e.number,ingredients:n}}))),Object(b.jsxs)(b.Fragment,{children:[t.length&&c.length?Object(b.jsx)("ul",{className:wt.a.list,children:c.map((function(e){return Object(b.jsx)("li",{children:Object(b.jsx)(It,{orderObj:e})},e._id)}))}):Object(b.jsx)("h1",{className:"text text_type_main-large",children:"\u041d\u0435\u0442 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),n&&Object(b.jsx)("h1",{children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}),a&&Object(b.jsx)("h1",{className:"text text_type_main-large",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})]})}var kt=n(115),Ft=n.n(kt);function qt(){var e=Fe(),t=ke((function(e){return e.ws})).wsConnected;return Object(a.useEffect)((function(){if(!t){console.log("dispatch WS_CONNECTION_START ");var n=localStorage.getItem("accessToken");n&&e({type:ge,payload:{wsUrl:"wss://norma.nomoreparties.space/orders",token:n.replace("Bearer ","")}})}return function(){console.log("dispatch WS_CONNECTION_STOP "),e({type:fe})}}),[e]),Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{className:"".concat(Ft.a.container," custom-scroll"),children:Object(b.jsx)(Rt,{})})})}function Pt(){var e=ke((function(e){return e.user.currentUser.email})),t=ke((function(e){return e.user.logout})),n=t.requestInProgress;t.requestSuccess;return e?n?Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0412\u044b\u0445\u043e\u0434\u0438\u043c..."})}):Object(b.jsx)(O.a,{to:"/"}):Object(b.jsx)(O.a,{to:"/login"})}function Ut(){var e=Fe();return Object(b.jsxs)("main",{className:Nt.a.container,children:[Object(b.jsxs)("nav",{className:"".concat(Nt.a.menu," mr-15"),children:[Object(b.jsxs)("ul",{children:[Object(b.jsx)("li",{className:Nt.a.menu_item,children:Object(b.jsx)(_.c,{to:"/profile",className:"".concat(Nt.a.link," text_type_main-medium text_color_inactive"),activeClassName:Nt.a.active_link,exact:!0,children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})}),Object(b.jsx)("li",{className:Nt.a.menu_item,children:Object(b.jsx)(_.c,{to:"/profile/orders",className:"".concat(Nt.a.link," text_type_main-medium text_color_inactive"),activeClassName:Nt.a.active_link,exact:!0,children:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432"})}),Object(b.jsx)("li",{className:Nt.a.menu_item,children:Object(b.jsx)(_.c,{to:"/profile/logout",className:"".concat(Nt.a.link," text_type_main-medium text_color_inactive"),activeClassName:Nt.a.active_link,onClick:function(){e((function(e){e({type:Y}),fetch(C+"/auth/logout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then(w).then((function(t){t&&t.success?(e({type:$,payload:{message:null===t||void 0===t?void 0:t.message}}),localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")):e({type:ee,payload:{message:null===t||void 0===t?void 0:t.message}})})).catch((function(t){e({type:ee,payload:{message:t.message}})}))}))},exact:!0,children:"\u0412\u044b\u0445\u043e\u0434"})})]}),Object(b.jsx)("p",{className:"text_type_main-default text_color_inactive mt-20",children:"\u0412 \u044d\u0442\u043e\u043c \u0440\u0430\u0437\u0434\u0435\u043b\u0435 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0432\u043e\u0438 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u043b\u044c\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435"})]}),Object(b.jsxs)(O.d,{children:[Object(b.jsx)(O.b,{path:"/profile",exact:!0,children:Object(b.jsx)(St,{})}),Object(b.jsx)(O.b,{path:"/profile/orders",exact:!0,children:Object(b.jsx)(qt,{})}),Object(b.jsx)(O.b,{path:"/profile/logout",exact:!0,children:Object(b.jsx)(Pt,{})})]})]})}function Lt(){return Object(b.jsx)("div",{className:xt.a.container,children:Object(b.jsx)("h1",{className:"text_type_main-medium",children:"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430"})})}function At(){return Object(b.jsxs)("div",{className:xt.a.container,children:[Object(b.jsx)("h1",{className:"".concat(xt.a.header," text text_type_main-large"),children:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430"}),Object(b.jsx)(lt,{})]})}var Mt=n(34),Dt=n.n(Mt);function Gt(){var e=ke((function(e){return e.ws})),t=e.ordersArray,n=e.totalOrders,a=e.totalOrdersToday,r=t.filter((function(e){return e.status===st.done})).slice(0,20),c=t.filter((function(e){return e.status===st.pending}));return Object(b.jsxs)("div",{className:Dt.a.container,children:[Object(b.jsxs)("div",{className:Dt.a.orderProgress,children:[Object(b.jsxs)("div",{className:Dt.a.statusColumn,children:[Object(b.jsx)("h3",{className:"text text_type_main-medium mb-6",children:"\u0413\u043e\u0442\u043e\u0432\u044b:"}),Object(b.jsx)("ul",{className:Dt.a.orderNumbers,children:r&&r.map((function(e){return Object(b.jsx)("li",{className:"".concat(Dt.a.readyOrder," text text_type_digits-default pb-2 pr-6"),children:e.number},e.number)}))})]}),Object(b.jsxs)("div",{className:"ml-9",children:[Object(b.jsx)("h3",{className:"text text_type_main-medium mb-6 ",children:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435:"}),Object(b.jsx)("ul",{className:Dt.a.orderNumbers,children:c&&c.map((function(e){return Object(b.jsx)("li",{className:"text text_type_digits-default pb-2 pr-6",children:e.number},e.number)}))})]})]}),Object(b.jsx)("h3",{className:"text text_type_main-medium mt-15",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0432\u0441\u0451 \u0432\u0440\u0435\u043c\u044f:"}),Object(b.jsx)("p",{className:"text text_type_digits-large",children:n.toLocaleString()}),a&&Object(b.jsxs)("div",{children:[Object(b.jsx)("h3",{className:"text text_type_main-medium mt-15",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0437\u0430 \u0441\u0435\u0433\u043e\u0434\u043d\u044f:"}),Object(b.jsx)("p",{className:"text text_type_digits-large",children:a.toLocaleString()})]})]})}var Qt=n(39),Bt=n.n(Qt);function zt(){var e=Fe(),t=ke((function(e){return e.ws})).wsConnected;return Object(a.useEffect)((function(){return t||(console.log("dispatch WS_CONNECTION_START "),e({type:ge,payload:{wsUrl:"wss://norma.nomoreparties.space/orders/all"}})),function(){console.log("dispatch WS_CONNECTION_STOP "),e({type:fe})}}),[e]),Object(b.jsx)(b.Fragment,{children:Object(b.jsx)("div",{className:Bt.a.container,children:Object(b.jsxs)("div",{className:Bt.a.centerContainer,children:[Object(b.jsx)("h1",{className:"text text_type_main-large pt-10 pb-10 pl-4",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u043e\u0432"}),Object(b.jsxs)("div",{className:Bt.a.ordersContainer,children:[Object(b.jsx)("div",{className:"".concat(Bt.a.feedContainer," custom-scroll"),children:Object(b.jsx)(Rt,{})}),Object(b.jsx)("div",{className:"".concat(Bt.a.statContainer," ml-15"),children:Object(b.jsx)(Gt,{})})]})]})})})}var Wt=n(116),Jt=n.n(Wt);function Vt(){return Object(b.jsx)("div",{className:Jt.a.container,children:Object(b.jsx)(bt,{})})}var Ht=n(117),Xt=["children"];function Kt(e){var t=e.children,n=Object(Ht.a)(e,Xt),a=ke((function(e){return e.user.currentUser})),r=a.email,c=a.userIsLoading;return!r&&c?Object(b.jsx)("h1",{className:"text text_type_main-large",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430"}):Object(b.jsx)(O.b,Object(E.a)(Object(E.a)({},n),{},{render:function(e){var n=e.location;return r?t:Object(b.jsx)(O.a,{to:{pathname:"/login",state:{from:n}}})}}))}function Zt(){var e=Object(O.h)(),t=Object(O.g)(),n=e.state&&e.state.prevLocation,r=Fe();Object(a.useEffect)((function(){r((function(e){e({type:k}),fetch(C+"/ingredients").then(w).then((function(t){t&&t.success?e({type:F,payload:t.data}):e({type:q})})).catch((function(t){e({type:q})}))}))}),[r]),Object(a.useEffect)((function(){r(_e())}),[r]);var c=function(){return t.goBack()},s=ke((function(e){return e.ingredients})),i=s.ingredientsAll,l=s.ingredientsRequestFailed,d=s.ingredientsRequestInProgress,u=ke((function(e){return e.user.currentUser.name}));return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(x,{currentUserName:u}),Object(b.jsxs)(O.d,{location:n||e,children:[Object(b.jsx)(O.b,{path:"/",exact:!0,children:Object(b.jsx)(pt.a,{backend:Ot.a,children:Object(b.jsxs)("main",{className:o.a.main,children:[i.length?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(Me,{}),Object(b.jsx)(ct,{})]}):null,l&&Object(b.jsx)("h1",{className:"text text_type_main-large",children:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445"}),d&&Object(b.jsx)("h1",{className:"text text_type_main-large",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430..."})]})})}),Object(b.jsx)(O.b,{path:"/login",exact:!0,children:Object(b.jsx)(gt,{})}),Object(b.jsx)(O.b,{path:"/register",exact:!0,children:Object(b.jsx)(ft,{})}),Object(b.jsx)(O.b,{path:"/forgot-password",exact:!0,children:Object(b.jsx)(ht,{})}),Object(b.jsx)(O.b,{path:"/reset-password",exact:!0,children:Object(b.jsx)(yt,{})}),Object(b.jsx)(Kt,{path:"/profile/orders/:orderNumber",exact:!0,children:Object(b.jsx)(Vt,{})}),Object(b.jsx)(Kt,{path:"/profile",children:Object(b.jsx)(Ut,{})}),Object(b.jsx)(O.b,{path:"/ingredients/:id",exact:!0,children:Object(b.jsx)(At,{})}),Object(b.jsx)(O.b,{path:"/feed",exact:!0,children:Object(b.jsx)(zt,{})}),Object(b.jsx)(O.b,{path:"/feed/:orderNumber",exact:!0,children:Object(b.jsx)(Vt,{})}),Object(b.jsx)(O.b,{children:Object(b.jsx)(Lt,{})})]}),n&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(O.b,{path:"/ingredients/:id",children:Object(b.jsx)(et,{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",onModalClose:c,children:Object(b.jsx)(lt,{})})}),Object(b.jsx)(O.b,{path:"/feed/:orderNumber",children:Object(b.jsx)(et,{onModalClose:c,children:Object(b.jsx)(bt,{})})}),Object(b.jsx)(Kt,{path:"/profile/orders/:orderNumber",children:Object(b.jsx)(et,{onModalClose:c,children:Object(b.jsx)(bt,{})})})]})]})}var Yt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,228)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),a(e),r(e),c(e),s(e)}))};s.a.render(Object(b.jsx)(r.a.StrictMode,{children:Object(b.jsx)(Ie.a,{store:Re,children:Object(b.jsx)(_.a,{children:Object(b.jsx)(Zt,{})})})}),document.getElementById("root")),Yt()},22:function(e,t,n){e.exports={container:"order-info_container__1_BLt",orderNumber:"order-info_orderNumber__1lJnx",readyOrder:"order-info_readyOrder__3MBsk",ingredientList:"order-info_ingredientList__7pp3K",ingrImage:"order-info_ingrImage__LP8jD",ingredientRow:"order-info_ingredientRow__1bfOi",titlePriceContainer:"order-info_titlePriceContainer__GVxg7",bottom:"order-info_bottom__30UZ4",price:"order-info_price__21Z1h",total:"order-info_total__3tuUR"}},24:function(e,t,n){e.exports={container:"order-list-item_container__2nfHA",header:"order-list-item_header__13Gy-",bottom:"order-list-item_bottom__20Tq4",total:"order-list-item_total__1T9Qx",ingredients:"order-list-item_ingredients__Nc9vf",imageContainer:"order-list-item_imageContainer__39m3T",ingrImage:"order-list-item_ingrImage__flAs5",overflowCounter:"order-list-item_overflowCounter__Hdmwg",orderLink:"order-list-item_orderLink__3QanG"}},27:function(e,t,n){e.exports={windowBody:"order-details_windowBody__eHcjb",doneImage:"order-details_doneImage__mT8jy",centerText:"order-details_centerText__j-z1u"}},32:function(e,t,n){e.exports={header:"app-header_header__1_EJf",link:"app-header_link__2asRg",link_active:"app-header_link_active__1SAIG",text_color_primary:"app-header_text_color_primary__3sFHs"}},33:function(e,t,n){e.exports={windowBody:"ingredients-details_windowBody__5SGFz",calories:"ingredients-details_calories__1zaqD",caloriesItem:"ingredients-details_caloriesItem__1LKup"}},34:function(e,t,n){e.exports={container:"feed-stat_container__3wQxv",orderProgress:"feed-stat_orderProgress__N31GN",orderNumbers:"feed-stat_orderNumbers__1wTcN",readyOrder:"feed-stat_readyOrder__3JGN9",statusColumn:"feed-stat_statusColumn__3Jayb"}},37:function(e,t,n){e.exports={container:"ingredient_container__QkGWJ",image:"ingredient_image__2KOXj",price:"ingredient_price__2fSur",itemName:"ingredient_itemName__2W_X7",link:"ingredient_link__3MdSV"}},38:function(e,t,n){e.exports={container:"burger-constructor_container__2Gd4z",drag_list:"burger-constructor_drag_list__2azu0",drag_element:"burger-constructor_drag_element__1qcBm",bun:"burger-constructor_bun__1wwi_",dropTarget:"burger-constructor_dropTarget__3vPtP"}},39:function(e,t,n){e.exports={container:"feed-page_container__3sOGu",centerContainer:"feed-page_centerContainer__3nz8h",ordersContainer:"feed-page_ordersContainer__2Xtmr",feedContainer:"feed-page_feedContainer__k_Nn_",statContainer:"feed-page_statContainer__133MI"}},53:function(e,t,n){e.exports={container:"burger-ingredients_container__9EGsa",tabs:"burger-ingredients_tabs__240Xk",groups:"burger-ingredients_groups__32cOk"}},54:function(e,t,n){e.exports={window:"modal_window__33yTe",title:"modal_title__3T8OQ",closeButton:"modal_closeButton__2nuuy"}},77:function(e,t,n){e.exports={icon:"icon-button_icon__2Qs7Q",text:"icon-button_text__rMrMY"}},80:function(e,t,n){e.exports={container:"drag-element_container__1qNxO",drag_icon:"drag-element_drag_icon__1Cg5G"}},81:function(e,t,n){e.exports={container:"cart-total_container__1Vvxc",currency:"cart-total_currency__7M0z0"}},9:function(e,t,n){e.exports={container:"common_container__3lrKU",form:"common_form__LolAb"}}},[[218,1,2]]]);
//# sourceMappingURL=main.fef6a707.chunk.js.map